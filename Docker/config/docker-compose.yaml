# Variables
# BOOTSTRAP
# export BOOTSTRAP=51.83.75.29
# export API_PORT=8080
# export PORT=46431

version: '3.6'

services:

# -------------=== signer node ===-------------
  signernode:
    image: ghcr.io/jffp113/signernode
#    container_name: signernode-1
    expose:
      - ${API_PORT}
      - 9000
      - 4004
    ports:
      - "${API_PORT}:8080"
      - "${PORT}:${PORT}"
    command: ./main --peerport=${PORT} -k ./resources/keys/1/ -b /ip4/${BOOTSTRAP}/tcp/55000/p2p/12D3KooWD1yUy23iVGYCYMZdm2fUy65WFaAc2H2i7ycBT3oJdN1B -vv

# -------------=== crypto ===-------------
  crypto:
    image: ghcr.io/jffp113/crypto
#    container_name: crypto-1
    command: bash -c "sleep 3; ./main -u tcp://signernode:9000"
    depends_on:
      - signernode

# -------------=== smartcontract ===-------------
  smartcontract:
    image: ghcr.io/jffp113/sawtooth-smartcontract
#    container_name: smartcontract-1
    command: intkey-tp-go -vv -C tcp://signernode:4004 -s TBLS256Optimistic
    depends_on:
      - signernode